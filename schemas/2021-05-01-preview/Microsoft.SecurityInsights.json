{
  "id": "https://schema.management.azure.com/schemas/2021-05-01-preview/Microsoft.SecurityInsights.json#",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Microsoft.SecurityInsights",
  "description": "Microsoft SecurityInsights Resource Types",
  "resourceDefinitions": {},
  "extension_resourceDefinitions": {
    "metadata": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "type": "string",
          "enum": [
            "2021-05-01-preview"
          ]
        },
        "etag": {
          "type": "string",
          "description": "Etag of the azure resource"
        },
        "name": {
          "type": "string",
          "description": "The Metadata name."
        },
        "properties": {
          "oneOf": [
            {
              "$ref": "#/definitions/MetadataProperties"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Metadata property bag."
        },
        "type": {
          "type": "string",
          "enum": [
            "Microsoft.SecurityInsights/metadata"
          ]
        }
      },
      "required": [
        "apiVersion",
        "name",
        "properties",
        "type"
      ],
      "description": "Microsoft.SecurityInsights/metadata"
    }
  },
  "definitions": {
    "MetadataAuthor": {
      "type": "object",
      "properties": {
        "email": {
          "type": "string",
          "description": "Email of author contact"
        },
        "link": {
          "type": "string",
          "description": "Link for author/vendor page"
        },
        "name": {
          "type": "string",
          "description": "Name of the author. Company or person."
        }
      },
      "description": "Publisher or creator of the content item."
    },
    "MetadataDependencies": {
      "type": "object",
      "properties": {
        "criteria": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "$ref": "#/definitions/MetadataDependencies"
              }
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "This is the list of dependencies we must fulfill, according to the AND/OR operator"
        },
        "id": {
          "type": "string",
          "description": "Static ID for the content.  Used to identify dependencies and content from solutions or community.  Hard-coded/static for out of the box content and solutions. Dynamic for user-created.  This is the resource name"
        },
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "dataConnector",
                "dataType",
                "workbook",
                "workbookTemplate",
                "playbook",
                "playbookTemplate",
                "analyticRuleTemplate",
                "analyticRule",
                "huntingQuery",
                "investigationQuery",
                "parser",
                "watchlist",
                "watchlistTemplate",
                "solution"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Type of the content item we depend on."
        },
        "name": {
          "type": "string",
          "description": "Name of the content item"
        },
        "operator": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "AND",
                "OR"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Operator used for list of dependencies in criteria array."
        },
        "version": {
          "type": "string",
          "description": "Version of the content.  Default and recommended format is numeric (e.g. 1, 1.0, 1.0.0, 1.0.0.0), following ARM template best practices.  Can also be any string, but then we cannot guarantee any version checks"
        }
      },
      "description": "Dependencies for the content item, what other content items it requires to work.  Can describe more complex dependencies using a recursive/nested structure. For a single dependency an id/kind/version can be supplied or operator/criteria for complex dependencies."
    },
    "MetadataProperties": {
      "type": "object",
      "properties": {
        "author": {
          "oneOf": [
            {
              "$ref": "#/definitions/MetadataAuthor"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Publisher or creator of the content item."
        },
        "dependencies": {
          "oneOf": [
            {
              "$ref": "#/definitions/MetadataDependencies"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Dependencies for the content item, what other content items it requires to work.  Can describe more complex dependencies using a recursive/nested structure. For a single dependency an id/kind/version can be supplied or operator/criteria for complex dependencies."
        },
        "id": {
          "type": "string",
          "description": "Static ID for the content.  Used to identify dependencies and content from solutions or community.  Hard-coded/static for out of the box content and solutions. Dynamic for user-created.  This is the resource name"
        },
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "dataConnector",
                "dataType",
                "workbook",
                "workbookTemplate",
                "playbook",
                "playbookTemplate",
                "analyticRuleTemplate",
                "analyticRule",
                "huntingQuery",
                "investigationQuery",
                "parser",
                "watchlist",
                "watchlistTemplate",
                "solution"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The kind of content the metadata is for."
        },
        "parentId": {
          "type": "string",
          "description": "Full parent resource ID of the content item the metadata is for.  This is the full resource ID including the scope (subscription and resource group)"
        },
        "source": {
          "oneOf": [
            {
              "$ref": "#/definitions/MetadataSource"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "The original source of the content item, where it comes from."
        },
        "support": {
          "oneOf": [
            {
              "$ref": "#/definitions/MetadataSupport"
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Support information for the content item."
        },
        "version": {
          "type": "string",
          "description": "Version of the content.  Default and recommended format is numeric (e.g. 1, 1.0, 1.0.0, 1.0.0.0), following ARM template best practices.  Can also be any string, but then we cannot guarantee any version checks"
        }
      },
      "required": [
        "id",
        "kind",
        "parentId"
      ],
      "description": "Metadata property bag."
    },
    "MetadataSource": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "ID of the content source.  The solution ID, workspace ID, etc"
        },
        "kind": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "localWorkspace",
                "community",
                "solution",
                "sourceRepository"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Source type of the content."
        },
        "name": {
          "type": "string",
          "description": "Name of the content source.  The repo name, solution name, LA workspace name etc."
        }
      },
      "required": [
        "kind"
      ],
      "description": "The original source of the content item, where it comes from."
    },
    "MetadataSupport": {
      "type": "object",
      "properties": {
        "email": {
          "type": "string",
          "description": "Email of support contact"
        },
        "link": {
          "type": "string",
          "description": "Link for support help, like to support page to open a ticket etc."
        },
        "name": {
          "type": "string",
          "description": "Name of the support contact. Company or person."
        },
        "tier": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "microsoft",
                "developer",
                "community"
              ]
            },
            {
              "$ref": "https://schema.management.azure.com/schemas/common/definitions.json#/definitions/expression"
            }
          ],
          "description": "Type of support for content item."
        }
      },
      "required": [
        "tier"
      ],
      "description": "Support information for the content item."
    }
  }
}